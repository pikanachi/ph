


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             datos, DATA
    2 00000000         
    3 00000000 00000009 
                       NUM_FILAS
                               EQU              9
    4 00000000 00000007 
                       PADDING EQU              7
    5 00000000 00000010 
                       NUM_COLUMNAS
                               EQU              NUM_FILAS + PADDING
    6 00000000 00 00 00 
              03 03 03 
              06 06 06 init_region
                               DCB              0, 0, 0, 3, 3, 3, 6, 6, 6
    7 00000009         
    8 00000009         
    9 00000009                 PRESERVE8                    ;Para hacer llamada
                                                            s a codigo c
   10 00000009                 AREA             cod, CODE
   11 00000000                 EXPORT           candidatos_actualizar_arm_c
   12 00000000                 EXPORT           candidatos_propagar_arm
   13 00000000                 EXPORT           candidatos_actualizar_arm
   14 00000000                 EXTERN           candidatos_propagar_c
   15 00000000                 ENTRY
   16 00000000         
   17 00000000         
   18 00000000         
   19 00000000         candidatos_actualizar_arm_c
   20 00000000 E92D407E        PUSH             {r1-r6,r14}
   21 00000004 E3A03000        mov              r3,#0       ;r3 = celdas_vacias
                                                            
   22 00000008 E3A01009        LDR              r1,=NUM_FILAS ;r1 = i (AMBAS, n
                                                            umero de iteracione
                                                            s del primer for y 
                                                            para direccionar la
                                                             fila de la celda)
   23 0000000C E2511001        subs             r1,r1,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
   24 00000010         
   25 00000010 E1A06000        mov              r6,r0       ;Como la direccion 
                                                            de la celda necesit
                                                            a estar en r0 para 
                                                            pasarlo como parame
                                                            tro a esVacia y eli
                                                            minaCandidatos
   26 00000014         
   27 00000014 E3A02009 
                       b11     LDR              r2,=NUM_FILAS ;r2 = j (AMBAS, n
                                                            umero de iteracione
                                                            s del segundo for y
                                                             para direccionar l
                                                            a columna de la cel
                                                            da)
   28 00000018 E2522001        subs             r2,r2,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d



ARM Macro Assembler    Page 2 


                                                            ireccionar bien las
                                                             celdas
   29 0000001C         
   30 0000001C E1A00006 
                       b21     mov              r0,r6       ;Recupero el valor 
                                                            de la primera celda
                                                             para calcular la q
                                                            ue toca
   31 00000020         
   32 00000020 E0800082        add              r0,r0,r2,LSL#1
   33 00000024 E0800281        add              r0,r0,r1,LSL#5 ;Calculo la dire
                                                            ccion de la celda
   34 00000028         
   35 00000028         ;-----------esVacia
   36 00000028 E1D050B0        ldrh             r5,[r0]     ;r1 = 31-16(DONT CA
                                                            RE) 15-0(INFORMACIO
                                                            N DE LA CELDA)
   37 0000002C E215400F        ands             r4,r5,#0x000F ;r0 = valor de la
                                                             celda
   38 00000030         ;-----------
   39 00000030         
   40 00000030         ;-----------elminaCandidatos si es vacia
   41 00000030 01D050B0        ldrheq           r5,[r0]     ;r1 = 31-16(DONT CA
                                                            RE) 15-0(INFORMACIO
                                                            N DE LA CELDA)
   42 00000034 0205507F        andeq            r5,r5,#0x007F
   43 00000038 01C050B0        strheq           r5,[r0]
   44 0000003C         ;-----------
   45 0000003C         
   46 0000003C E2522001        subs             r2,r2,#1    ;Una iteracion del 
                                                            segundo for
   47 00000040 5AFFFFF5        bpl              b21         ;Acaba cuando j < 0
                                                             para calcular la c
                                                            olumna 0
   48 00000044         
   49 00000044 E2511001        subs             r1,r1,#1    ;Una iteracion del 
                                                            primer for
   50 00000048 5AFFFFF1        bpl              b11         ;Acaba cuando i < 0
                                                             para calcular la f
                                                            ila 0
   51 0000004C         
   52 0000004C         ;-----------SEGUNDO PAR DE BUCLES ANIDADOS
   53 0000004C E3A01009        LDR              r1,=NUM_FILAS ;r1 = i (AMBAS, n
                                                            umero de iteracione
                                                            s del primer for y 
                                                            para direccionar la
                                                             fila de la celda)
   54 00000050 E2511001        subs             r1,r1,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
   55 00000054         
   56 00000054 E1A06000        mov              r6,r0       ;Como la direccion 
                                                            de la celda necesit
                                                            a estar en r0 para 
                                                            pasarlo como parame
                                                            tro a esVacia y eli
                                                            minaCandidatos



ARM Macro Assembler    Page 3 


   57 00000058         
   58 00000058 E3A02009 
                       b12     LDR              r2,=NUM_FILAS ;r2 = j (AMBAS, n
                                                            umero de iteracione
                                                            s del segundo for y
                                                             para direccionar l
                                                            a columna de la cel
                                                            da)
   59 0000005C E2522001        subs             r2,r2,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
   60 00000060         
   61 00000060 E1A00006 
                       b22     mov              r0,r6       ;Recupero el valor 
                                                            de la primera celda
                                                             para calcular la q
                                                            ue toca
   62 00000064         
   63 00000064 E0800082        add              r0,r0,r2,LSL#1
   64 00000068 E0800281        add              r0,r0,r1,LSL#5 ;Calculo la dire
                                                            ccion de la celda
   65 0000006C         
   66 0000006C         ;-----------esVacia
   67 0000006C E1D050B0        ldrh             r5,[r0]     ;r1 = 31-16(DONT CA
                                                            RE) 15-0(INFORMACIO
                                                            N DE LA CELDA)
   68 00000070 E215400F        ands             r4,r5,#0x000F ;r0 = valor de la
                                                             celda
   69 00000074         ;-----------   
   70 00000074         
   71 00000074         
   72 00000074         ;cmp  r0,#0      ;Comparo el resultado para acutalizar l
                       os flags
   73 00000074         ;POP  {r0}      ;Recupero, ya habiendo comparado r0, el 
                       valor de r0 para que lo use elimina candidatos
   74 00000074 02833001        addeq            r3,r3,#1    ;Si estaba vacia su
                                                            mo 1 a celdas vacia
                                                            s
   75 00000078 E92D000E        PUSH             {r1-r3}     ;Para guardar r1 y 
                                                            r2 (ya que necesito
                                                             pasarselo como par
                                                            ametro, pero me los
                                                             destroza)
   76 0000007C 11A00006        movne            r0,r6
   77 00000080 1BFFFFFE        blne             candidatos_propagar_c ;Si la ce
                                                            lda estaba vacia, p
                                                            ropago sus candidat
                                                            os(r0 = direcion ce
                                                            lda, r1 = i, r2 = j
                                                            )
   78 00000084 E8BD000E        POP              {r1-r3}
   79 00000088         
   80 00000088 E2522001        subs             r2,r2,#1    ;Una iteracion del 
                                                            segundo for
   81 0000008C 5AFFFFF3        bpl              b22         ;Acaba cuando j < 0
                                                             para calcular la c
                                                            olumna 0



ARM Macro Assembler    Page 4 


   82 00000090         
   83 00000090 E2511001        subs             r1,r1,#1    ;Una iteracion del 
                                                            primer for
   84 00000094 5AFFFFEF        bpl              b12         ;Acaba cuando i < 0
                                                             para calcular la f
                                                            ila 0
   85 00000098         
   86 00000098 E1A00003        mov              r0,r3       ;se pasan las celda
                                                            s vacías a r0 para 
                                                            devolverlas
   87 0000009C E8BD807E        POP              {r1-r6,pc}
   88 000000A0         
   89 000000A0         
   90 000000A0         
   91 000000A0         
   92 000000A0         ; PARÁMTEROS:
   93 000000A0         ; r0 = @ini_cuadricula
   94 000000A0         ; r1 = fila
   95 000000A0         ; r2 = columna
   96 000000A0         
   97 000000A0         candidatos_propagar_arm              ;push{lr}
   98 000000A0         ;mov fp,sp
   99 000000A0         ;push{r12,lr}     ; registros a usar
  100 000000A0 E92D57F8        push{r3-r10,r12,lr}          ; registros a usar
  101 000000A4         
  102 000000A4         ; obtener la cuadricula[fila][columna]
  103 000000A4         ; ------------------------------------------------------
                       ------------------------------------------------------
  104 000000A4         ;mov r3,#NUM_COLUMNAS
  105 000000A4         
  106 000000A4 E0806281        add              r6,r0,r1,LSL#5 ; r6 = @ini_fila
                                                            
  107 000000A8 E0865082        add              r5,r6,r2,LSL#1 ; r5 = cuadricul
                                                            a[fila][columna]
  108 000000AC         
  109 000000AC E1D5C0B0        ldrh             r12,[r5]    ; r12 = cuadricula[
                                                            fila][columna] = me
                                                            m[@ini_fila + col*2
                                                            ] (r6+r5 = @cuadric
                                                            ula[fila][columna])
                                                            
  110 000000B0         
  111 000000B0         ; valor = celda_leer_valor(cuadricula[fila][columna])
  112 000000B0         ;-------------------------------celda_leer_valor
  113 000000B0 E20CC00F        and              r12,#0x00F  ;r12 = valor     
  114 000000B4         ;-------------------------------      
  115 000000B4         ; for (j=NUM_FILAS;j>0;j--)
  116 000000B4         ; ------------------------------------------------------
                       ------------------------------------------------------
  117 000000B4 E3A07009        mov              r7,#NUM_FILAS ; r7 = j = 9  
  118 000000B8         for1
  119 000000B8         
  120 000000B8         ; celda_eliminar_candidato(&cuadricula[r6],r12)
  121 000000B8         ;-------------------------------celda_eliminar_candidato
                       
  122 000000B8 E3A03040        mov              r3,#0x40    ;0000 0000 0100 000
                                                            0
  123 000000BC E1A03C13        mov              r3,r3,LSL r12 ;muevo el 1 tanta
                                                            s posiciones como v



ARM Macro Assembler    Page 5 


                                                            alor y así obtengo 
                                                            la máscara para eli
                                                            minar el candidato
  124 000000C0         
  125 000000C0 E1D640B0        ldrh             r4,[r6]     ;r4 = mem[r5]
  126 000000C4 E1844003        orr              r4,r4,r3    ;r4 = or bit a bit 
                                                            para poner a 1 el b
                                                            it de r4 que está a
                                                             1 en r3 y no tocar
                                                             el resto
  127 000000C8 E1C640B0        strh             r4,[r6]     ;mem[r5] = r4
  128 000000CC         ;-------------------------------
  129 000000CC         
  130 000000CC E2866002        add              r6,r6,#2    ; avanza a la colum
                                                            na siguiente
  131 000000D0 E2577001        subs             r7,r7,#1    ; r7 = j-- (concici
                                                            ón de fin de bucle 
                                                            j = 0)
  132 000000D4 1AFFFFF7        bne              for1
  133 000000D8         
  134 000000D8         
  135 000000D8         
  136 000000D8         
  137 000000D8         
  138 000000D8         ; for (i=NUM_FILAS;i>0;i--)
  139 000000D8         ; ------------------------------------------------------
                       ------------------------------------------------------
  140 000000D8 E3A07009        mov              r7,#NUM_FILAS ; r7 = i = 9
  141 000000DC E0455281        sub              r5,r5,r1,LSL#5 ; r5 = @ini_col
  142 000000E0         
  143 000000E0         
  144 000000E0         
  145 000000E0         for2                                 ; celda_eliminar_ca
                                                            ndidato(&cuadricula
                                                            [r6],r12)
  146 000000E0         ;-------------------------------celda_eliminar_candidato
                       
  147 000000E0 E3A03040        mov              r3,#0x40    ;0000 0000 0100 000
                                                            0
  148 000000E4 E1A03C13        mov              r3,r3,LSL r12 ;muevo el 1 tanta
                                                            s posiciones como v
                                                            alor y así obtengo 
                                                            la máscara para eli
                                                            minar el candidato
  149 000000E8         
  150 000000E8 E1D540B0        ldrh             r4,[r5]     ;r4 = mem[r5]
  151 000000EC E1844003        orr              r4,r4,r3    ;r4 = or bit a bit 
                                                            para poner a 1 el b
                                                            it de r4 que está a
                                                             1 en r3 y no tocar
                                                             el resto
  152 000000F0 E1C540B0        strh             r4,[r5]     ;mem[r5] = r4
  153 000000F4         ;-------------------------------     ; libera los paráme
                       tros de pila
  154 000000F4         
  155 000000F4 E2855020        add              r5,r5,#32   ; r5 = cuadricula[f
                                                            ila + 1][columna] 
  156 000000F8 E2577001        subs             r7,r7,#1    ; r7 = i-- (concici
                                                            ón de fin de bucle 



ARM Macro Assembler    Page 6 


                                                            i = 0)
  157 000000FC 1AFFFFF7        bne              for2
  158 00000100         
  159 00000100         ; Encontrar el inicio de la región
  160 00000100         ; ------------------------------------------------------
                       ------------------------------------------------------
  161 00000100         ; init_i = init_region[fila];
  162 00000100         ; init_j = init_region[columna];
  163 00000100         ; end_i = init_i + 3; //En verdad el fin es init_i + 3 -
                       1 pero el for es < no <=
  164 00000100         ; end_j = init_j + 3;
  165 00000100         
  166 00000100 E59F61A8        LDR              r6,=init_region
  167 00000104         
  168 00000104 E0867001        add              r7,r6,r1
  169 00000108 E0868002        add              r8,r6,r2
  170 0000010C         
  171 0000010C         ;mov r3,r1,LSL #1
  172 0000010C E5D77000        ldrb             r7,[r7]     ; r7  = init_i (fil
                                                            a)
  173 00000110 E5D88000        ldrb             r8,[r8]     ; r8  = init_j (col
                                                            )
  174 00000114 E2879003        add              r9,r7,#3    ; r9  = end_i
  175 00000118 E288A003        add              r10,r8,#3   ; r10 = end_j
  176 0000011C         
  177 0000011C         for3                                 ; for (i=init_i; i<
                                                            end_i; i++)  ; avan
                                                            zar fila a fila
  178 0000011C         ; ------------------------------------------------------
                       ------------------------------------------------------
  179 0000011C E1A0B008        mov              r11,r8      ; se restaura en r9
                                                             el valor de la col
                                                            umna para repetir f
                                                            or4
  180 00000120         
  181 00000120         ; Calcular la @cuadricula[init_i][init_j]
  182 00000120 E0805287        add              r5,r0,r7,LSL#5
  183 00000124 E0855088        add              r5,r5,r8,LSL#1
  184 00000128         
  185 00000128         
  186 00000128         
  187 00000128         for4                                 ; for(j=init_j; j<e
                                                            nd_j; j++)    ; ava
                                                            nzar columna a colu
                                                            mna
  188 00000128         ; ------------------------------------------------------
                       ------------------------------------------------------
  189 00000128         ; celda_eliminar_candidato(&cuadricula[r6],r12)
  190 00000128         ; celda_eliminar_candidato(&cuadricula[r6],r12)
  191 00000128         ;-------------------------------celda_eliminar_candidato
                       
  192 00000128 E3A03040        mov              r3,#0x40    ;0000 0000 0100 000
                                                            0
  193 0000012C E1A03C13        mov              r3,r3,LSL r12 ;muevo el 1 tanta
                                                            s posiciones como v
                                                            alor y así obtengo 
                                                            la máscara para eli
                                                            minar el candidato
  194 00000130         



ARM Macro Assembler    Page 7 


  195 00000130 E1D540B0        ldrh             r4,[r5]     ;r4 = mem[r5]
  196 00000134 E1844003        orr              r4,r4,r3    ;r4 = or bit a bit 
                                                            para poner a 1 el b
                                                            it de r4 que está a
                                                             1 en r3 y no tocar
                                                             el resto
  197 00000138 E1C540B0        strh             r4,[r5]     ;mem[r5] = r4
  198 0000013C         ;-------------------------------
  199 0000013C         
  200 0000013C E2855002        add              r5,r5,#2    ; avanza r6 en la r
                                                            egión
  201 00000140 E28BB001        add              r11,r11,#1  ; avanza en la colu
                                                            mna
  202 00000144 E15B000A        cmp              r11,r10     ; se compara r3 (in
                                                            it_j que va avanzan
                                                            do por las columnas
                                                            ) con end_j
  203 00000148 1AFFFFF6        bne              for4
  204 0000014C         
  205 0000014C E2877001        add              r7,r7,#1    ; avanzar la fila e
                                                            n para for3
  206 00000150 E1570009        cmp              r7,r9       ; se compara r7 (in
                                                            it_i que va avanzan
                                                            do por las filas) c
                                                            on end_i
  207 00000154 1AFFFFF0        bne              for3
  208 00000158         
  209 00000158 E8BD97F8        pop              {r3-r10,r12,pc} ; restaurar los
                                                             registros usados y
                                                             vuelta del pc a su
                                                            doku_2021.c
  210 0000015C         ;pop {r12,pc}     ; restaurar los registros usados y vue
                       lta del pc a sudoku_2021.c
  211 0000015C         
  212 0000015C         
  213 0000015C         
  214 0000015C         candidatos_actualizar_arm
  215 0000015C E92D5FFE        PUSH             {r1-r12,r14}
  216 00000160 E3A03000        mov              r3,#0       ;r3 = celdas_vacias
                                                            
  217 00000164 E3A01009        LDR              r1,=NUM_FILAS ;r1 = i (AMBAS, n
                                                            umero de iteracione
                                                            s del primer for y 
                                                            para direccionar la
                                                             fila de la celda)
  218 00000168 E2511001        subs             r1,r1,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
  219 0000016C         
  220 0000016C E1A06000        mov              r6,r0       ;Como la direccion 
                                                            de la celda necesit
                                                            a estar en r0 para 
                                                            pasarlo como parame
                                                            tro a esVacia y eli
                                                            minaCandidatos
  221 00000170         
  222 00000170 E3A02009 



ARM Macro Assembler    Page 8 


                       arm_armb11
                               LDR              r2,=NUM_FILAS ;r2 = j (AMBAS, n
                                                            umero de iteracione
                                                            s del segundo for y
                                                             para direccionar l
                                                            a columna de la cel
                                                            da)
  223 00000174 E2522001        subs             r2,r2,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
  224 00000178         
  225 00000178 E1A00006 
                       arm_armb21
                               mov              r0,r6       ;Recupero el valor 
                                                            de la primera celda
                                                             para calcular la q
                                                            ue toca
  226 0000017C         
  227 0000017C E0800082        add              r0,r0,r2,LSL#1
  228 00000180 E0800281        add              r0,r0,r1,LSL#5 ;Calculo la dire
                                                            ccion de la celda
  229 00000184         
  230 00000184         ;-----------esVacia
  231 00000184 E1D050B0        ldrh             r5,[r0]     ;r1 = 31-16(DONT CA
                                                            RE) 15-0(INFORMACIO
                                                            N DE LA CELDA)
  232 00000188 E215400F        ands             r4,r5,#0x000F ;r0 = valor de la
                                                             celda
  233 0000018C         ;-----------
  234 0000018C         
  235 0000018C         ;-----------elminaCandidatos si es vacia
  236 0000018C 01D050B0        ldrheq           r5,[r0]     ;r1 = 31-16(DONT CA
                                                            RE) 15-0(INFORMACIO
                                                            N DE LA CELDA)
  237 00000190 0205507F        andeq            r5,r5,#0x007F
  238 00000194 01C050B0        strheq           r5,[r0]
  239 00000198         ;-----------
  240 00000198         
  241 00000198 E2522001        subs             r2,r2,#1    ;Una iteracion del 
                                                            segundo for
  242 0000019C 5AFFFFF5        bpl              arm_armb21  ;Acaba cuando j < 0
                                                             para calcular la c
                                                            olumna 0
  243 000001A0         
  244 000001A0 E2511001        subs             r1,r1,#1    ;Una iteracion del 
                                                            primer for
  245 000001A4 5AFFFFF1        bpl              arm_armb11  ;Acaba cuando i < 0
                                                             para calcular la f
                                                            ila 0
  246 000001A8         
  247 000001A8         ;-----------SEGUNDO PAR DE BUCLES ANIDADOS
  248 000001A8 E3A01009        LDR              r1,=NUM_FILAS ;r1 = i (AMBAS, n
                                                            umero de iteracione
                                                            s del primer for y 
                                                            para direccionar la
                                                             fila de la celda)
  249 000001AC E2511001        subs             r1,r1,#1    ;Como el valor de N



ARM Macro Assembler    Page 9 


                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
  250 000001B0         
  251 000001B0 E1A06000        mov              r6,r0       ;Como la direccion 
                                                            de la celda necesit
                                                            a estar en r0 para 
                                                            pasarlo como parame
                                                            tro a esVacia y eli
                                                            minaCandidatos
  252 000001B4         
  253 000001B4 E3A02009 
                       arm_armb12
                               LDR              r2,=NUM_FILAS ;r2 = j (AMBAS, n
                                                            umero de iteracione
                                                            s del segundo for y
                                                             para direccionar l
                                                            a columna de la cel
                                                            da)
  254 000001B8 E2522001        subs             r2,r2,#1    ;Como el valor de N
                                                            UM_FILAS es 9, le r
                                                            esto 1 para poder d
                                                            ireccionar bien las
                                                             celdas
  255 000001BC         
  256 000001BC E1A00006 
                       arm_armb22
                               mov              r0,r6       ;Recupero el valor 
                                                            de la primera celda
                                                             para calcular la q
                                                            ue toca
  257 000001C0         
  258 000001C0 E0800082        add              r0,r0,r2,LSL#1
  259 000001C4 E0800281        add              r0,r0,r1,LSL#5 ;Calculo la dire
                                                            ccion de la celda
  260 000001C8         
  261 000001C8         ;-----------esVacia
  262 000001C8 E1D050B0        ldrh             r5,[r0]     ;r5 = 31-16(DONT CA
                                                            RE) 15-0(INFORMACIO
                                                            N DE LA CELDA)
  263 000001CC E215400F        ands             r4,r5,#0x000F ;r0 = valor de la
                                                             celda
  264 000001D0         ;-----------   
  265 000001D0         
  266 000001D0         
  267 000001D0         ;cmp  r0,#0      ;Comparo el resultado para acutalizar l
                       os flags
  268 000001D0         ;POP  {r0}      ;Recupero, ya habiendo comparado r0, el 
                       valor de r0 para que lo use elimina candidatos
  269 000001D0 02833001        addeq            r3,r3,#1    ;Si estaba vacia su
                                                            mo 1 a celdas vacia
                                                            s
  270 000001D4 11A00006        movne            r0,r6
  271 000001D8 0A00002E        beq              noPropagar
  272 000001DC         
  273 000001DC         ;r0 = cuadricula 
  274 000001DC         ;r1 = fila
  275 000001DC         ;r2 = columna



ARM Macro Assembler    Page 10 


  276 000001DC         ;r3 = celdas_vacias
  277 000001DC         ;r6 = cuadricula backup
  278 000001DC         
  279 000001DC         
  280 000001DC         
  281 000001DC E92D0048        push{r3,r6}
  282 000001E0         ;-----------candidatos_propagar_arm
  283 000001E0         
  284 000001E0         ; obtener la cuadricula[fila][columna]
  285 000001E0         ; ------------------------------------------------------
                       ------------------------------------------------------
  286 000001E0         ;mov r3,#NUM_COLUMNAS
  287 000001E0         
  288 000001E0 E0806281        add              r6,r0,r1,LSL#5 ; r6 = @ini_fila
                                                            
  289 000001E4 E0865082        add              r5,r6,r2,LSL#1 ; r5 = cuadricul
                                                            a[fila][columna]
  290 000001E8         
  291 000001E8 E1D5C0B0        ldrh             r12,[r5]    ; r12 = cuadricula[
                                                            fila][columna] = me
                                                            m[@ini_fila + col*2
                                                            ] (r6+r5 = @cuadric
                                                            ula[fila][columna])
                                                            
  292 000001EC         
  293 000001EC         ; valor = celda_leer_valor(cuadricula[fila][columna])
  294 000001EC         ;-------------------------------celda_leer_valor
  295 000001EC E20CC00F        and              r12,#0x00F  ;r12 = valor     
  296 000001F0         ;-------------------------------      
  297 000001F0         ; for (j=NUM_FILAS;j>0;j--)
  298 000001F0         ; ------------------------------------------------------
                       ------------------------------------------------------
  299 000001F0 E3A07009        mov              r7,#NUM_FILAS ; r7 = j = 9  
  300 000001F4         arm_armfor1
  301 000001F4         
  302 000001F4         ; celda_eliminar_candidato(&cuadricula[r6],r12)
  303 000001F4         ;-------------------------------celda_eliminar_candidato
                       
  304 000001F4 E3A03040        mov              r3,#0x40    ;0000 0000 0100 000
                                                            0
  305 000001F8 E1A03C13        mov              r3,r3,LSL r12 ;muevo el 1 tanta
                                                            s posiciones como v
                                                            alor y así obtengo 
                                                            la máscara para eli
                                                            minar el candidato
  306 000001FC         
  307 000001FC E1D640B0        ldrh             r4,[r6]     ;r4 = mem[r5]
  308 00000200 E1844003        orr              r4,r4,r3    ;r4 = or bit a bit 
                                                            para poner a 1 el b
                                                            it de r4 que está a
                                                             1 en r3 y no tocar
                                                             el resto
  309 00000204 E1C640B0        strh             r4,[r6]     ;mem[r5] = r4
  310 00000208         ;-------------------------------
  311 00000208         
  312 00000208 E2866002        add              r6,r6,#2    ; avanza a la colum
                                                            na siguiente
  313 0000020C E2577001        subs             r7,r7,#1    ; r7 = j-- (concici
                                                            ón de fin de bucle 



ARM Macro Assembler    Page 11 


                                                            j = 0)
  314 00000210 1AFFFFF7        bne              arm_armfor1
  315 00000214         
  316 00000214         
  317 00000214         
  318 00000214         
  319 00000214         
  320 00000214         ; for (i=NUM_FILAS;i>0;i--)
  321 00000214         ; ------------------------------------------------------
                       ------------------------------------------------------
  322 00000214 E3A07009        mov              r7,#NUM_FILAS ; r7 = i = 9
  323 00000218 E0455281        sub              r5,r5,r1,LSL#5 ; r5 = @ini_col
  324 0000021C         
  325 0000021C         
  326 0000021C         
  327 0000021C         arm_armfor2                          ; celda_eliminar_ca
                                                            ndidato(&cuadricula
                                                            [r6],r12)
  328 0000021C         ;-------------------------------celda_eliminar_candidato
                       
  329 0000021C E3A03040        mov              r3,#0x40    ;0000 0000 0100 000
                                                            0
  330 00000220 E1A03C13        mov              r3,r3,LSL r12 ;muevo el 1 tanta
                                                            s posiciones como v
                                                            alor y así obtengo 
                                                            la máscara para eli
                                                            minar el candidato
  331 00000224         
  332 00000224 E1D540B0        ldrh             r4,[r5]     ;r4 = mem[r5]
  333 00000228 E1844003        orr              r4,r4,r3    ;r4 = or bit a bit 
                                                            para poner a 1 el b
                                                            it de r4 que está a
                                                             1 en r3 y no tocar
                                                             el resto
  334 0000022C E1C540B0        strh             r4,[r5]     ;mem[r5] = r4
  335 00000230         ;-------------------------------     ; libera los paráme
                       tros de pila
  336 00000230         
  337 00000230 E2855020        add              r5,r5,#32   ; r5 = cuadricula[f
                                                            ila + 1][columna] 
  338 00000234 E2577001        subs             r7,r7,#1    ; r7 = i-- (concici
                                                            ón de fin de bucle 
                                                            i = 0)
  339 00000238 1AFFFFF7        bne              arm_armfor2
  340 0000023C         
  341 0000023C         ; Encontrar el inicio de la región
  342 0000023C         ; ------------------------------------------------------
                       ------------------------------------------------------
  343 0000023C         ; init_i = init_region[fila];
  344 0000023C         ; init_j = init_region[columna];
  345 0000023C         ; end_i = init_i + 3; //En verdad el fin es init_i + 3 -
                       1 pero el for es < no <=
  346 0000023C         ; end_j = init_j + 3;
  347 0000023C         
  348 0000023C E59F606C        LDR              r6,=init_region
  349 00000240         
  350 00000240 E0867001        add              r7,r6,r1
  351 00000244 E0868002        add              r8,r6,r2
  352 00000248         



ARM Macro Assembler    Page 12 


  353 00000248         ;mov r3,r1,LSL #1
  354 00000248 E5D77000        ldrb             r7,[r7]     ; r7  = init_i (fil
                                                            a)
  355 0000024C E5D88000        ldrb             r8,[r8]     ; r8  = init_j (col
                                                            )
  356 00000250 E2879003        add              r9,r7,#3    ; r9  = end_i
  357 00000254 E288A003        add              r10,r8,#3   ; r10 = end_j
  358 00000258         
  359 00000258         arm_armfor3                          ; for (i=init_i; i<
                                                            end_i; i++)  ; avan
                                                            zar fila a fila
  360 00000258         ; ------------------------------------------------------
                       ------------------------------------------------------
  361 00000258 E1A0B008        mov              r11,r8      ; se restaura en r9
                                                             el valor de la col
                                                            umna para repetir f
                                                            or4
  362 0000025C         
  363 0000025C         ; Calcular la @cuadricula[init_i][init_j]
  364 0000025C E0805287        add              r5,r0,r7,LSL#5
  365 00000260 E0855088        add              r5,r5,r8,LSL#1
  366 00000264         
  367 00000264         
  368 00000264         
  369 00000264         arm_armfor4                          ; for(j=init_j; j<e
                                                            nd_j; j++)    ; ava
                                                            nzar columna a colu
                                                            mna
  370 00000264         ; ------------------------------------------------------
                       ------------------------------------------------------
  371 00000264         ; celda_eliminar_candidato(&cuadricula[r6],r12)
  372 00000264         ; celda_eliminar_candidato(&cuadricula[r6],r12)
  373 00000264         ;-------------------------------celda_eliminar_candidato
                       
  374 00000264 E3A03040        mov              r3,#0x40    ;0000 0000 0100 000
                                                            0
  375 00000268 E1A03C13        mov              r3,r3,LSL r12 ;muevo el 1 tanta
                                                            s posiciones como v
                                                            alor y así obtengo 
                                                            la máscara para eli
                                                            minar el candidato
  376 0000026C         
  377 0000026C E1D540B0        ldrh             r4,[r5]     ;r4 = mem[r5]
  378 00000270 E1844003        orr              r4,r4,r3    ;r4 = or bit a bit 
                                                            para poner a 1 el b
                                                            it de r4 que está a
                                                             1 en r3 y no tocar
                                                             el resto
  379 00000274 E1C540B0        strh             r4,[r5]     ;mem[r5] = r4
  380 00000278         ;-------------------------------
  381 00000278         
  382 00000278 E2855002        add              r5,r5,#2    ; avanza r6 en la r
                                                            egión
  383 0000027C E28BB001        add              r11,r11,#1  ; avanza en la colu
                                                            mna
  384 00000280 E15B000A        cmp              r11,r10     ; se compara r3 (in
                                                            it_j que va avanzan
                                                            do por las columnas
                                                            ) con end_j



ARM Macro Assembler    Page 13 


  385 00000284 1AFFFFF6        bne              arm_armfor4
  386 00000288         
  387 00000288 E2877001        add              r7,r7,#1    ; avanzar la fila e
                                                            n para for3
  388 0000028C E1570009        cmp              r7,r9       ; se compara r7 (in
                                                            it_i que va avanzan
                                                            do por las filas) c
                                                            on end_i
  389 00000290 1AFFFFF0        bne              arm_armfor3
  390 00000294         
  391 00000294         ;-------------------------------------------------------
                       ------------------------------
  392 00000294 E8BD0048        pop{r3,r6}
  393 00000298         
  394 00000298         
  395 00000298         noPropagar
  396 00000298         
  397 00000298 E2522001        subs             r2,r2,#1    ;Una iteracion del 
                                                            segundo for
  398 0000029C 5AFFFFC6        bpl              arm_armb22  ;Acaba cuando j < 0
                                                             para calcular la c
                                                            olumna 0
  399 000002A0         
  400 000002A0 E2511001        subs             r1,r1,#1    ;Una iteracion del 
                                                            primer for
  401 000002A4 5AFFFFC2        bpl              arm_armb12  ;Acaba cuando i < 0
                                                             para calcular la f
                                                            ila 0
  402 000002A8         
  403 000002A8 E1A00003        mov              r0,r3       ;se pasan las celda
                                                            s vacías a r0 para 
                                                            devolverlas
  404 000002AC E8BD9FFE        POP              {r1-r12,pc}
  405 000002B0         
  406 000002B0                 END
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --apcs=interwork --depend=.\o
bjects\funciones.d -o.\objects\funciones.o -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_
v5\ARM\CMSIS\Include -IC:\Keil_v5\ARM\INC\Philips --predefine="__EVAL SETA 1" -
-predefine="__UVISION_VERSION SETA 526" --list=.\listings\funciones.lst funcion
es.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

datos 00000000

Symbol: datos
   Definitions
      At line 1 in file funciones.s
   Uses
      None
Comment: datos unused
init_region 00000000

Symbol: init_region
   Definitions
      At line 6 in file funciones.s
   Uses
      At line 166 in file funciones.s
      At line 348 in file funciones.s

2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

arm_armb11 00000170

Symbol: arm_armb11
   Definitions
      At line 222 in file funciones.s
   Uses
      At line 245 in file funciones.s
Comment: arm_armb11 used once
arm_armb12 000001B4

Symbol: arm_armb12
   Definitions
      At line 253 in file funciones.s
   Uses
      At line 401 in file funciones.s
Comment: arm_armb12 used once
arm_armb21 00000178

Symbol: arm_armb21
   Definitions
      At line 225 in file funciones.s
   Uses
      At line 242 in file funciones.s
Comment: arm_armb21 used once
arm_armb22 000001BC

Symbol: arm_armb22
   Definitions
      At line 256 in file funciones.s
   Uses
      At line 398 in file funciones.s
Comment: arm_armb22 used once
arm_armfor1 000001F4

Symbol: arm_armfor1
   Definitions
      At line 300 in file funciones.s
   Uses
      At line 314 in file funciones.s
Comment: arm_armfor1 used once
arm_armfor2 0000021C

Symbol: arm_armfor2
   Definitions
      At line 327 in file funciones.s
   Uses
      At line 339 in file funciones.s
Comment: arm_armfor2 used once
arm_armfor3 00000258

Symbol: arm_armfor3
   Definitions
      At line 359 in file funciones.s
   Uses
      At line 389 in file funciones.s
Comment: arm_armfor3 used once
arm_armfor4 00000264

Symbol: arm_armfor4



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 369 in file funciones.s
   Uses
      At line 385 in file funciones.s
Comment: arm_armfor4 used once
b11 00000014

Symbol: b11
   Definitions
      At line 27 in file funciones.s
   Uses
      At line 50 in file funciones.s
Comment: b11 used once
b12 00000058

Symbol: b12
   Definitions
      At line 58 in file funciones.s
   Uses
      At line 84 in file funciones.s
Comment: b12 used once
b21 0000001C

Symbol: b21
   Definitions
      At line 30 in file funciones.s
   Uses
      At line 47 in file funciones.s
Comment: b21 used once
b22 00000060

Symbol: b22
   Definitions
      At line 61 in file funciones.s
   Uses
      At line 81 in file funciones.s
Comment: b22 used once
candidatos_actualizar_arm 0000015C

Symbol: candidatos_actualizar_arm
   Definitions
      At line 214 in file funciones.s
   Uses
      At line 13 in file funciones.s
Comment: candidatos_actualizar_arm used once
candidatos_actualizar_arm_c 00000000

Symbol: candidatos_actualizar_arm_c
   Definitions
      At line 19 in file funciones.s
   Uses
      At line 11 in file funciones.s
Comment: candidatos_actualizar_arm_c used once
candidatos_propagar_arm 000000A0

Symbol: candidatos_propagar_arm
   Definitions
      At line 97 in file funciones.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

      At line 12 in file funciones.s
Comment: candidatos_propagar_arm used once
cod 00000000

Symbol: cod
   Definitions
      At line 10 in file funciones.s
   Uses
      None
Comment: cod unused
for1 000000B8

Symbol: for1
   Definitions
      At line 118 in file funciones.s
   Uses
      At line 132 in file funciones.s
Comment: for1 used once
for2 000000E0

Symbol: for2
   Definitions
      At line 145 in file funciones.s
   Uses
      At line 157 in file funciones.s
Comment: for2 used once
for3 0000011C

Symbol: for3
   Definitions
      At line 177 in file funciones.s
   Uses
      At line 207 in file funciones.s
Comment: for3 used once
for4 00000128

Symbol: for4
   Definitions
      At line 187 in file funciones.s
   Uses
      At line 203 in file funciones.s
Comment: for4 used once
noPropagar 00000298

Symbol: noPropagar
   Definitions
      At line 395 in file funciones.s
   Uses
      At line 271 in file funciones.s
Comment: noPropagar used once
21 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

NUM_COLUMNAS 00000010

Symbol: NUM_COLUMNAS
   Definitions
      At line 5 in file funciones.s
   Uses
      None
Comment: NUM_COLUMNAS unused
NUM_FILAS 00000009

Symbol: NUM_FILAS
   Definitions
      At line 3 in file funciones.s
   Uses
      At line 5 in file funciones.s
      At line 22 in file funciones.s
      At line 27 in file funciones.s
      At line 53 in file funciones.s
      At line 58 in file funciones.s
      At line 117 in file funciones.s
      At line 140 in file funciones.s
      At line 217 in file funciones.s
      At line 222 in file funciones.s
      At line 248 in file funciones.s
      At line 253 in file funciones.s
      At line 299 in file funciones.s
      At line 322 in file funciones.s

PADDING 00000007

Symbol: PADDING
   Definitions
      At line 4 in file funciones.s
   Uses
      At line 5 in file funciones.s
Comment: PADDING used once
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

candidatos_propagar_c 00000000

Symbol: candidatos_propagar_c
   Definitions
      At line 14 in file funciones.s
   Uses
      At line 77 in file funciones.s
Comment: candidatos_propagar_c used once
1 symbol
361 symbols in table
